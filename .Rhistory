x1$child_5_17 <- ifelse(x1$q11_4 >= 5 & x1$q11_4 <18, 1, 0)
x1$adult <- ifelse(x1$q11_4 > 18, 1, 0)
# For each unique "slno" in df "x", sum the number of adults, children U5 and children 5-17.
# Change "slno" to "hhid" if you wish to count based on HHID. This gives 1 record for each house
x2 <- ddply(x, .(slno),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17))
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
mac <- "/Users/Matthew/Google Drive/Copenhagen\\Bangladesh - Cholera\\Map Stuff"
pc <- "C:/Users/wrz741/Dropbox/C5 Baseline data/Pre-double entry"
setwd(pc)
rm(mac, pc)
library(plyr)
library(memisc) # read .spss files
HH_member_info<-as.data.set(spss.system.file('Q11.sav'), stringsAsFactors=FALSE)
# make it easier to work with in R.
# Please change "x" to a variable name that makes sense for you!
x1 <-as.data.frame(HH_member_info)
# make dummy variable for each age range so counting will be easier
x1$child_U5 <- ifelse(x1$q11_4 < 5, 1, 0)
x1$child_5_17 <- ifelse(x1$q11_4 >= 5 & x1$q11_4 <18, 1, 0)
x1$adult <- ifelse(x1$q11_4 > 18, 1, 0)
# For each unique "slno" in df "x", sum the number of adults, children U5 and children 5-17.
# Change "slno" to "hhid" if you wish to count based on HHID. This gives 1 record for each house
x2 <- ddply(x1, .(slno),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17))
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
mac <- "/Users/Matthew/Google Drive/Copenhagen\\Bangladesh - Cholera\\Map Stuff"
pc <- "C:/Users/wrz741/Dropbox/C5 Baseline data/Pre-double entry"
setwd(pc)
rm(mac, pc)
library(plyr)
library(memisc) # read .spss files
HH_member_info<-as.data.set(spss.system.file('Q11.sav'), stringsAsFactors=FALSE)
# make it easier to work with in R.
# Please change "x" to a variable name that makes sense for you!
x1 <-as.data.frame(HH_member_info)
# make dummy variable for each age range so counting will be easier
x1$child_U5 <- ifelse(x1$q11_4 < 5, 1, 0)
x1$child_5_17 <- ifelse(x1$q11_4 >= 5 & x1$q11_4 <18, 1, 0)
x1$adult <- ifelse(x1$q11_4 > 18, 1, 0)
# For each unique "slno" in df "x", sum the number of adults, children U5 and children 5-17.
# Change "slno" to "hhid" if you wish to count based on HHID. This gives 1 record for each house
x2 <- ddply(x1, .(slno),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17))
# Add HHID variable to make our final dataset. This gives one record for each person.
x3 <- merge(x[,c(1,10)], x2, by = "slno")
# check to make sure summation works as expected. Returns "TRUE" if it works
sum(x2$children_U5) == sum(x1$child_U5)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
mac <- "/Users/Matthew/Google Drive/Copenhagen\\Bangladesh - Cholera\\Map Stuff"
pc <- "C:/Users/wrz741/Dropbox/C5 Baseline data/Pre-double entry"
setwd(pc)
rm(mac, pc)
library(plyr)
library(memisc) # read .spss files
HH_member_info<-as.data.set(spss.system.file('Q11.sav'), stringsAsFactors=FALSE)
# make it easier to work with in R.
# Please change "x" to a variable name that makes sense for you!
x1 <-as.data.frame(HH_member_info)
# make dummy variable for each age range so counting will be easier
x1$child_U5 <- ifelse(x1$q11_4 < 5, 1, 0)
x1$child_5_17 <- ifelse(x1$q11_4 >= 5 & x1$q11_4 <18, 1, 0)
x1$adult <- ifelse(x1$q11_4 > 18, 1, 0)
# For each unique "slno" in df "x", sum the number of adults, children U5 and children 5-17.
# Change "slno" to "hhid" if you wish to count based on HHID. This gives 1 record for each house
x2 <- ddply(x1, .(slno),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17))
# Add HHID variable to make our final dataset. This gives one record for each person.
x3 <- merge(x[,c(1,10)], x2, by = "slno")
# check to make sure summation works as expected. Returns "TRUE" if it works
sum(x2$children_U5) == sum(x1$child_U5)
sum(x2$child_5_17)== sum(x1$child_5_17)
sum(x2$adult)== sum(x1$adult)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
mac <- "/Users/Matthew/Google Drive/Copenhagen\\Bangladesh - Cholera\\Map Stuff"
pc <- "C:/Users/wrz741/Dropbox/C5 Baseline data/Pre-double entry"
setwd(pc)
rm(mac, pc)
library(plyr)
library(memisc) # read .spss files
HH_member_info<-as.data.set(spss.system.file('Q11.sav'), stringsAsFactors=FALSE)
# make it easier to work with in R.
# Please change "x" to a variable name that makes sense for you!
x1 <-as.data.frame(HH_member_info)
# make dummy variable for each age range so counting will be easier
x1$child_U5 <- ifelse(x1$q11_4 < 5, 1, 0)
x1$child_5_17 <- ifelse(x1$q11_4 >= 5 & x1$q11_4 <18, 1, 0)
x1$adult <- ifelse(x1$q11_4 > 18, 1, 0)
# For each unique "slno" in df "x", sum the number of adults, children U5 and children 5-17.
# Change "slno" to "hhid" if you wish to count based on HHID. This gives 1 record for each house
x2 <- ddply(x1, .(slno),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17))
# Add HHID variable to make our final dataset. This gives one record for each person.
x3 <- merge(x[,c(1,10)], x2, by = "slno")
# check to make sure summation works as expected. Returns "TRUE" if it works
sum(x2$children_U5) == sum(x1$child_U5)
sum(x2$children_5_17)== sum(x1$child_5_17)
View(x2)
View(x1)
x1$hhid==x1$slno
View(x1)
as.table(x2)
as.table(x2$slno)
table(x2$slno)
View(x2)
table(x1$slno)
table(x1$hhid)
x2 <- ddply(x1, .(hhid),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17))
# check to make sure summation works as expected. Returns "TRUE" if it works
sum(x2$children_U5) == sum(x1$child_U5)
sum(x2$children_5_17)== sum(x1$child_5_17)
sum(x2$adult)== sum(x1$adult)
sum(table(x1$hhid))
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
mac <- "/Users/Matthew/Google Drive/Copenhagen\\Bangladesh - Cholera\\Map Stuff"
pc <- "C:/Users/wrz741/Dropbox/C5 Baseline data/Pre-double entry"
setwd(pc)
rm(mac, pc)
library(plyr)
library(memisc) # read .spss files
HH_member_info<-as.data.set(spss.system.file('Q11.sav'), stringsAsFactors=FALSE)
# make it easier to work with in R.
# Please change "x" to a variable name that makes sense for you!
x1 <-as.data.frame(HH_member_info)
# make dummy variable for each age range so counting will be easier
x1$child_U5 <- ifelse(x1$q11_4 < 5, 1, 0)
x1$child_5_17 <- ifelse(x1$q11_4 >= 5 & x1$q11_4 <18, 1, 0)
x1$adult <- ifelse(x1$q11_4 > 18, 1, 0)
# For each unique "slno" in df "x", sum the number of adults, children U5 and children 5-17.
# Change "slno" to "hhid" if you wish to count based on HHID. This gives 1 record for each house
x2 <- ddply(x1, .(hhid),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17),
all_ppl = adults + children_U5 + children_5_17)
sum(x2$all_ppl)
View(x2)
View(x1)
View(x1)
View(x2)
View(x1)
sum(x1$child_U5) + sum(x1$child_5_17) + sum(x1$adult)
sum(x2$all_ppl)
sum(table(x1$hhid))
View(x1)
if(x1$child_U5 < 1 & x1$child_5_17 < 1 & x1$adult <1) {
return "0"
}
if(x1$child_U5 < 1 & x1$child_5_17 < 1 & x1$adult <1) {
return "0"
if(x1$child_U5 < 1 & x1$child_5_17 < 1 & x1$adult <1) {
return 0
for (i in 1:nrow(x$1)){
if(x1$child_U5 < 1 & x1$child_5_17 < 1 & x1$adult <1) {
for (i in 1:nrow(x$1)){
for (i in 1:nrow(x1)){
if(x1$child_U5 < 1 & x1$child_5_17 < 1 & x1$adult <1) {
return "y"
for (i in 1:nrow(x1)){
if(x1$child_U5 < 1 & x1$child_5_17 < 1 & x1$adult <1) {
return 0
}
for (i in 1:nrow(x1)){
if(x1$child_U5 < 1 & x1$child_5_17 < 1 & x1$adult <1) {
print 0
}
for (i in 1:nrow(x1)){
if(x1$child_U5 < 1 & x1$child_5_17 < 1 & x1$adult <1) {
print "0"
check <- as.data.frame()
for (i in 1:nrow(x1)){
check <- as.data.frame
check <- as.data.frame
for (i in 1:nrow(x1)){
if(x1$child_U5 < 1 & x1$child_5_17 < 1 & x1$adult <1) {
check <- as.data.frame
for (i in 1:nrow(x1)){
if(x1$child_U5[i] < 1 & x1$child_5_17[i] < 1 & x1$adult[i] <1) {
check[i]
check <- as.data.frame
for (i in 1:nrow(x1)){
if(x1$child_U5[i] < 1 & x1$child_5_17[i] < 1 & x1$adult[i] <1) {
check[i] <- 1
}
}
check <- data.frame()
for (i in 1:nrow(x1)){
if(x1$child_U5[i] < 1 & x1$child_5_17[i] < 1 & x1$adult[i] <1) {
check[i] <- 1
}
}
check <- data.frame(1,nrow(x1))
View(check)
check <- data.frame(1,nrow(x1))
for (i in 1:nrow(x1)){
if(x1$child_U5[i] < 1 & x1$child_5_17[i] < 1 & x1$adult[i] <1) {
check[i] <- 1
}
}
check <- data.frame(1,nrow(x1))
for (i in 1:nrow(x1)){
if(x1$child_U5[i] < 1 & x1$child_5_17[i] < 1 & x1$adult[i] <1) {
check[i] <- 1
} else {
check[i]<-0  }
}
View(check)
check <- data.frame(1)
for (i in 1:nrow(x1)){
if(x1$child_U5[i] < 1 & x1$child_5_17[i] < 1 & x1$adult[i] <1) {
check[i,] <- 1
} else {
check[i,]<-0  }
}
View(check)
View(x1)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
mac <- "/Users/Matthew/Google Drive/Copenhagen\\Bangladesh - Cholera\\Map Stuff"
pc <- "C:/Users/wrz741/Dropbox/C5 Baseline data/Pre-double entry"
setwd(pc)
rm(mac, pc)
library(plyr)
library(memisc) # read .spss files
HH_member_info<-as.data.set(spss.system.file('Q11.sav'), stringsAsFactors=FALSE)
# make it easier to work with in R.
# Please change "x" to a variable name that makes sense for you!
x1 <-as.data.frame(HH_member_info)
# make dummy variable for each age range so counting will be easier
x1$child_U5 <- ifelse(x1$q11_4 < 5, 1, 0)
x1$child_5_17 <- ifelse(x1$q11_4 >= 5 & x1$q11_4 <18, 1, 0)
x1$adult <- ifelse(x1$q11_4 >= 18, 1, 0)
# For each unique "slno" in df "x", sum the number of adults, children U5 and children 5-17.
# Change "slno" to "hhid" if you wish to count based on HHID. This gives 1 record for each house
x2 <- ddply(x1, .(hhid),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17),
all_ppl = adults + children_U5 + children_5_17)
# Add HHID variable to make our final dataset. This gives one record for each person.
x3 <- merge(x[,c(1,10)], x2, by = "slno")
# check to make sure summation works as expected. Returns "TRUE" if it works
sum(x2$children_U5) == sum(x1$child_U5)
sum(x2$children_5_17)== sum(x1$child_5_17)
sum(x2$adult)== sum(x1$adult)
sum(x2$all_ppl)
sum(table(x1$hhid))
sum(x1$child_U5) + sum(x1$child_5_17) + sum(x1$adult)
sum(table(x1$hhid)) == sum(x1$child_U5) + sum(x1$child_5_17) + sum(x1$adult)
sum(x2$all_ppl) == sum(table(x1$hhid)) == sum(x1$child_U5) + sum(x1$child_5_17) + sum(x1$adult)
sum(x2$all_ppl) == sum(table(x1$hhid))
sum(check)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
mac <- "/Users/Matthew/Google Drive/Copenhagen\\Bangladesh - Cholera\\Map Stuff"
pc <- "C:/Users/wrz741/Dropbox/C5 Baseline data/Pre-double entry"
setwd(pc)
rm(mac, pc)
library(plyr)
library(memisc) # read .spss files
HH_member_info<-as.data.set(spss.system.file('Q11.sav'), stringsAsFactors=FALSE)
# make it easier to work with in R.
# Please change "x" to a variable name that makes sense for you!
x1 <-as.data.frame(HH_member_info)
# make dummy variable for each age range so counting will be easier
x1$child_U5 <- ifelse(x1$q11_4 < 5, 1, 0)
x1$child_5_17 <- ifelse(x1$q11_4 >= 5 & x1$q11_4 <18, 1, 0)
x1$adult <- ifelse(x1$q11_4 >= 18, 1, 0)
# For each unique "slno" in df "x", sum the number of adults, children U5 and children 5-17.
# Change "slno" to "hhid" if you wish to count based on HHID. This gives 1 record for each house
x2 <- ddply(x1, .(hhid),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17),
all_ppl = adults + children_U5 + children_5_17)
# Add HHID variable to make our final dataset. This gives one record for each person.
x3 <- merge(x[,c(1,10)], x2, by = "slno")
# DATA CHECKING!! ---------------------------------------------------------
# check to make sure summation works as expected. Returns "TRUE" if it works
sum(x2$children_U5) == sum(x1$child_U5)
sum(x2$children_5_17)== sum(x1$child_5_17)
sum(x2$adult)== sum(x1$adult)
sum(x2$all_ppl) == sum(table(x1$hhid))
sum(table(x1$hhid)) == sum(x1$child_U5) + sum(x1$child_5_17) + sum(x1$adult)
# CHECK to make sure there are not people who were not counted
check <- data.frame(1)
for (i in 1:nrow(x1)){
if(x1$child_U5[i] < 1 & x1$child_5_17[i] < 1 & x1$adult[i] <1) {
check[i,] <- 1
} else {
check[i,]<-0  }
}
# Sums to 0 if everyone was counted
sum(check)
x2 <- ddply(x1, .(slno),
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
mac <- "/Users/Matthew/Google Drive/Copenhagen\\Bangladesh - Cholera\\Map Stuff"
pc <- "C:/Users/wrz741/Dropbox/C5 Baseline data/Pre-double entry"
setwd(pc)
rm(mac, pc)
library(plyr)
library(memisc) # read .spss files
HH_member_info<-as.data.set(spss.system.file('Q11.sav'), stringsAsFactors=FALSE)
# make it easier to work with in R.
# Please change "x" to a variable name that makes sense for you!
x1 <-as.data.frame(HH_member_info)
# make dummy variable for each age range so counting will be easier
x1$child_U5 <- ifelse(x1$q11_4 < 5, 1, 0)
x1$child_5_17 <- ifelse(x1$q11_4 >= 5 & x1$q11_4 <18, 1, 0)
x1$adult <- ifelse(x1$q11_4 >= 18, 1, 0)
# For each unique "slno" in df "x", sum the number of adults, children U5 and children 5-17.
# Change "slno" to "hhid" if you wish to count based on HHID. This gives 1 record for each house
x2 <- ddply(x1, .(slno),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17),
all_ppl = adults + children_U5 + children_5_17)
# Add HHID variable to make our final dataset. This gives one record for each person.
x3 <- merge(x[,c(1,10)], x2, by = "slno")
# DATA CHECKING!! ---------------------------------------------------------
# check to make sure summation works as expected. Returns "TRUE" if it works
sum(x2$children_U5) == sum(x1$child_U5)
sum(x2$children_5_17)== sum(x1$child_5_17)
sum(x2$adult)== sum(x1$adult)
sum(x2$all_ppl) == sum(table(x1$hhid))
sum(table(x1$hhid)) == sum(x1$child_U5) + sum(x1$child_5_17) + sum(x1$adult)
# CHECK to make sure there are not people who were not counted
check <- data.frame(1)
for (i in 1:nrow(x1)){
if(x1$child_U5[i] < 1 & x1$child_5_17[i] < 1 & x1$adult[i] <1) {
check[i,] <- 1
} else {
check[i,]<-0  }
}
# Sums to 0 if everyone was counted
sum(check)
View(x2)
x2 <- ddply(x1, .(hhid),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17),
all_ppl = adults + children_U5 + children_5_17)
# Add HHID variable to make our final dataset. This gives one record for each person.
x3 <- merge(x[,c(1,10)], x2, by = "slno")
# DATA CHECKING!! ---------------------------------------------------------
# check to make sure summation works as expected. Returns "TRUE" if it works
sum(x2$children_U5) == sum(x1$child_U5)
sum(x2$children_5_17)== sum(x1$child_5_17)
sum(x2$adult)== sum(x1$adult)
sum(x2$all_ppl) == sum(table(x1$hhid))
sum(table(x1$hhid)) == sum(x1$child_U5) + sum(x1$child_5_17) + sum(x1$adult)
# CHECK to make sure there are not people who were not counted
check <- data.frame(1)
for (i in 1:nrow(x1)){
if(x1$child_U5[i] < 1 & x1$child_5_17[i] < 1 & x1$adult[i] <1) {
check[i,] <- 1
} else {
check[i,]<-0  }
}
# Sums to 0 if everyone was counted
sum(check)
View(x2)
View(x1)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
mac <- ""
pc <- "C:/Users/wrz741/Dropbox/C5 Baseline data/Pre-double entry"
setwd(pc)
rm(mac, pc)
library(plyr)
library(memisc) # read .spss files
HH_member_info<-as.data.set(spss.system.file('Q11.sav'), stringsAsFactors=FALSE)
# make it easier to work with in R.
# Please change "x" to a variable name that makes sense for you!
x1 <-as.data.frame(HH_member_info)
x1$hhid <-formatC(x1$hhid, width = 3, format = 'd', flag = 0)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
mac <- ""
pc <- "C:/Users/wrz741/Dropbox/C5 Baseline data/Pre-double entry"
setwd(pc)
rm(mac, pc)
library(plyr)
library(memisc) # read .spss files
HH_member_info<-as.data.set(spss.system.file('Q11.sav'), stringsAsFactors=FALSE)
# make it easier to work with in R.
# Please change "x" to a variable name that makes sense for you!
x1 <-as.data.frame(HH_member_info)
x1$hhid <-formatC(x1$hhid, width = 3, format = 'd', flag = 0)
# make dummy variable for each age range so counting will be easier
x1$child_U5 <- ifelse(x1$q11_4 < 5, 1, 0)
x1$child_5_17 <- ifelse(x1$q11_4 >= 5 & x1$q11_4 <18, 1, 0)
x1$adult <- ifelse(x1$q11_4 >= 18, 1, 0)
# For each unique "slno" in df "x", sum the number of adults, children U5 and children 5-17.
# Change "slno" to "hhid" if you wish to count based on HHID. This gives 1 record for each house
x2 <- ddply(x1, .(hhid),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17),
all_ppl = adults + children_U5 + children_5_17)
# Add HHID variable to make our final dataset. This gives one record for each person.
# x3 <- merge(x[,c(1,10)], x2, by = "slno")
# DATA CHECKING!! ---------------------------------------------------------
# check to make sure summation works as expected. Returns "TRUE" if it works
sum(x2$children_U5) == sum(x1$child_U5)
sum(x2$children_5_17)== sum(x1$child_5_17)
sum(x2$adult)== sum(x1$adult)
sum(x2$all_ppl) == sum(table(x1$hhid))
sum(table(x1$hhid)) == sum(x1$child_U5) + sum(x1$child_5_17) + sum(x1$adult)
# CHECK to make sure there are not people who were not counted
check <- data.frame(1)
for (i in 1:nrow(x1)){
if(x1$child_U5[i] < 1 & x1$child_5_17[i] < 1 & x1$adult[i] <1) {
check[i,] <- 1
} else {
check[i,]<-0  }
}
# Sums to 0 if everyone was counted
sum(check)
View(x1)
View(x2)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5_R_Codes/Rdata"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
CurrentDate <- function(x) {
if (!is.na(x)) {
return(x)
} else {
x <- endDate
return(x)
}
}
load("X-1 Choleraphone distribution 31Jul15.Rdata")
load("X-2 monthly visits 31Jul15.Rdata")
endDate <- as.Date('31-12-14', "%d-%m-%y")
# RESTRICT TO DESIRED TIME-FRAME
a1 <- x1[x1$Date.of.phone.distribution <= endDate, ]
# Calculate number of days each unique household is active
for (i in 1:nrow(a1)) {
a1$Date.of.withdrawl.or.move[i] <- CurrentDate(a1$Date.of.withdrawl.or.move[i])
}
a1$daysActive <- as.numeric(a1$Date.of.withdrawl.or.move - a1$Date.of.phone.distribution)
rm(x1)
View(x2)
