# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# turn date characters into date format
x1_2 <- lapply(x1[,3:5], as.Date, format = "%d.%m.%y")
# Populate the withdrawl/move date as the current date for calculation purposes.
# Use a custom function
CurrentDate <- function(x) {
if (is.na(x )) {
x <- Sys.Date()
return (x)
}
}
x1_2 <- lapply(x1[,5], CurrentDate)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# turn date characters into date format
x1_2 <- lapply(x1[,3:5], as.Date, format = "%d.%m.%y")
# Populate the withdrawl/move date as the current date for calculation purposes.
# Use a custom function
# Use a custom function
CurrentDate <- function(x) {
if (is.na(x)) {
x <- Sys.Date()
}
}
x1_3 <- lapply(x1[,5], CurrentDate)
x1_3 <- lapply(x1_2[3], CurrentDate, x1_2[3])
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# turn date characters into date format
x1_2 <- lapply(x1[,3:5], as.Date, format = "%d.%m.%y")
# Populate the withdrawl/move date as the current date for calculation purposes.
# Use a custom function
CurrentDate <- function(x) {
if (is.na(x)) {
x <- Sys.Date()
return(x)
}
}
x1_3 <- lapply(x1_2[3], CurrentDate, x1_2[3])
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# turn date characters into date format
x1_2 <- lapply(x1[,3:5], as.Date, format = "%d.%m.%y")
# Populate the withdrawl/move date as the current date for calculation purposes.
# Use a custom function
CurrentDate <- function(x) {
if (is.na(x)) {
x <- Sys.Date()
return(x)
}
}
x1_3 <- lapply(x1_2[3], CurrentDate, x1_2[3])
# format dates to be more human readable
x1_3 <- lapply(x1_2[3], CurrentDate)
is.na(x1$Date.of.withdrawl.or.move)
is.na(x1_2[3])
x1_3 <- lapply(x1_2[3][,1], CurrentDate)
x1_3 <- lapply(x1_2[3][1], CurrentDate)
is.na(x1_2[3])
is.na(x1_2[3][1])
is.na(x1_2[3][,1])
is.na(x1_2[3][:])
is.na(x1_2[3][,])
is.na(x1_2[3][0])
is.na(x1_2$Date.of.withdrawl.or.move)
CurrentDate(x1_2$Date.of.withdrawl.or.move)# merge back into original dataset
x1_3 <- lapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
x1_3 <- lapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
CurrentDate <- function(x) {
if (!is.na(x)) {
return(x)
} else {
x <- Sys.Date()
return(x)
}
}
x1_3 <- lapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
x1_2$ <- lapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# turn date characters into date format
x1_2 <- lapply(x1[,3:5], as.Date, format = "%d.%m.%y")
# Populate the withdrawl/move date as the current date for calculation purposes.
# Use a custom function
CurrentDate <- function(x) {
if (!is.na(x)) {
return(x)
} else {
x <- Sys.Date()
return(x)
}
}
x1_2$Date.of.withdrawl.or.move <- lapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
is.na(x1_2$Date.of.withdrawl.or.move)
x1_2[3]
x1_2[3][1]
x1_2[3][1][1]
x1_2[3][1][1][1]
x1_2$Date.of.withdrawl.or.move
x1_2$Date.of.withdrawl.or.move[1]
x1_2$Date.of.withdrawl.or.move[,]
x1_2$Date.of.withdrawl.or.move[,1]
x1_2$Date.of.withdrawl.or.move[2]
x1_2$Date.of.withdrawl.or.move[:]
x1_2$Date.of.withdrawl.or.move[end]
x1_2$Date.of.withdrawl.or.move[1:end]
x1_2$Date.of.withdrawl.or.move[1:length(x1)]
x1_2$Date.of.withdrawl.or.move[1:nrow(x1)]
x1_2$Date.of.withdrawl.or.move[1:nrow(x1)][1]
x2 <- cbind(x1[1:2], x1_2[1], x1_2[2], x1_2$Date.of.withdrawl.or.move[1:nrow(x1)])
View(x2)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# turn date characters into date format
x1_2 <- lapply(x1[,3:5], as.Date, format = "%d.%m.%y")
# Populate the withdrawl/move date as the current date for calculation purposes.
# Use a custom function
CurrentDate <- function(x) {
if (!is.na(x)) {
return(x)
} else {
x <- Sys.Date()
return(x)
}
}
x1_2$Date.of.withdrawl.or.move <- sapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
x1_2$Date.of.withdrawl.or.move <- apply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
x1_2$Date.of.withdrawl.or.move <- mapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
x1_2$Date.of.withdrawl.or.move <- tapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
x1_2$Date.of.withdrawl.or.move <- rapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
x1_2$Date.of.withdrawl.or.move <- rapply(x1_2[3, CurrentDate)
x1_2$Date.of.withdrawl.or.move <- rapply(x1_2[3], CurrentDate)
x1_2$Date.of.withdrawl.or.move <- lapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# turn date characters into date format
x1_2 <- lapply(x1[,3:5], as.Date, format = "%d.%m.%y")
# Populate the withdrawl/move date as the current date for calculation purposes.
# Use a custom function
CurrentDate <- function(x) {
if (!is.na(x)) {
return(x)
} else {
x <- Sys.Date()
return(x)
}
}
x1_2$Date.of.withdrawl.or.move <- lapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# turn date characters into date format
x1_2 <- lapply(x1[,3:5], as.Date, format = "%d.%m.%y")
# Populate the withdrawl/move date as the current date for calculation purposes.
# Use a custom function
CurrentDate <- function(x) {
if (!is.na(x)) {
return(x)
} else {
x <- Sys.Date()
return(x)
}
}
CurrentDate(x1_2$Date.of.withdrawl.or.move)
CurrentDate(x1_2$Date.of.withdrawl.or.move
CurrentDate(x1_2$Date.of.withdrawl.or.move)
View(CurrentDate)
x1_2$Date.of.withdrawl.or.move <- sapply(x1_2$Date.of.withdrawl.or.move, CurrentDate)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# turn date characters into date format
x1_2 <- lapply(x1[,3:5], as.Date, format = "%d.%m.%y")
# Populate the withdrawl/move date as the current date for calculation purposes.
# Use a custom function
CurrentDate <- function(x) {
if (!is.na(x)) {
return(x)
} else {
x <- Sys.Date()
return(x)
}
}
x1_2$Date.of.withdrawl.or.move <- as.Date(sapply(x1_2$Date.of.withdrawl.or.move, CurrentDate))
x1_2$Date.of.withdrawl.or.move <- (sapply(x1_2$Date.of.withdrawl.or.move, CurrentDate))
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# turn date characters into date format
x1_2 <- lapply(x1[,3:5], as.Date, format = "%d.%m.%y")
# Populate the withdrawl/move date as the current date for calculation purposes.
# Use a custom function
CurrentDate <- function(x) {
if (!is.na(x)) {
return(x)
} else {
x <- Sys.Date()
return(x)
}
}
CurrentDate(x1_2$Date.of.withdrawl.or.move[1])
CurrentDate(x1_2$Date.of.withdrawl.or.move[2])
for (i in 1:nrow(x1)) {
x1_2$Date.of.withdrawl.or.move[i] <- CurrentDate(x1_2$Date.of.withdrawl.or.move[i])
}
x2 <- cbind(x1[1:2], x1_2[1], x1_2[2], x1_2[3])
View(x2)
rm(x1, x1_2)
# Calculate number of days each unique household is active
x2$daysActive <- as.numeric(x2$Date.of.withdrawl.or.move - x2$Date.of.phone.distribution)
hist(x2$daysActive, breaks = 15)
View(x2)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# turn date characters into date format
x1$HHID <- formatC(x1$HHID, width = 4, format = 'd', flag = 0)
x1$HHID <- formatC(x1$HHID, width = 3, format = 'd', flag = 0)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# Format HHID and Listing number to have standard length.
x1$HHID <- formatC(x1$HHID, width = 3, format = 'd', flag = 0)
x1$Listing.number <- formatC(x1$Listing.number, width = 4, format = 'd', flag = 0)
x1$HHID <- x1$Listing.number <- as.numeric()
x1$HHID <- as.numeric(x1$HHID)
x1$Listing.number <- as.numeric(x1$Listing.number)
x1$HHID <-formatC(x1$HHID, width = 3, format = 'd', flag = 0)
x1$Listing.number <- formatC(x1$Listing.number, width = 4, format = 'd', flag = 0)
x1$HHID <- as.integer (x1$HHID)
x1$Listing.number <- as.integer(x1$Listing.number)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-1 Choleraphone distribution 31Jul15.csv", sep=";")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# Format HHID and Listing number to have standard length.
x1$HHID <-formatC(x1$HHID, width = 3, format = 'd', flag = 0)
x1$Listing.number <- formatC(x1$Listing.number, width = 4, format = 'd', flag = 0)
x1$unique_ID <- paste(x1$HHID, x1$Listing.number, sep="-")
View(x1)
# turn date characters into date format
x1_2 <- lapply(x1[,3:5], as.Date, format = "%d.%m.%y")
# Populate the withdrawl/move date as the current date for calculation purposes.
# Use a custom function
CurrentDate <- function(x) {
if (!is.na(x)) {
return(x)
} else {
x <- Sys.Date()
return(x)
}
}
for (i in 1:nrow(x1)) {
x1_2$Date.of.withdrawl.or.move[i] <- CurrentDate(x1_2$Date.of.withdrawl.or.move[i])
}
# Merge to create finished dataset
x2 <- cbind(x1[c(1:2, 6)], x1_2[1], x1_2[2], x1_2[3])
rm(x1, x1_2)
View(x2)
View(x2)
# Calculate number of days each unique household is active
x2$daysActive <- as.numeric(x2$Date.of.withdrawl.or.move - x2$Date.of.phone.distribution)
hist(x2$daysActive, breaks = 15)
mean(x2$daysActive)
x1 <- read.csv("X-2 monthly visits 31Jul15.csv", sep=";")
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-2 monthly visits 31Jul15.csv", sep=";")
# remove rows without a HHID
View(x1)
x1 <- read.csv("X-2 monthly visits 31Jul15.csv", sep=",")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
View(x1)
x1 <- read.csv("X-2 monthly visits 31Jul15.csv", sep=",")
x1 <- x1[complete.cases(x1$HHID),]
View(x1)
# Format HHID and Listing number to have standard length. Then create unique ID
x1$HHID <-formatC(x1$HHID, width = 3, format = 'd', flag = 0)
x1$Listing.number <- formatC(x1$Listing.number, width = 4, format = 'd', flag = 0)
# create unique ID called "unique_HHID_list_no"
x1$unique_ID <- paste(x1$HHID, x1$Listing.number, sep="-")
x1 <- as.Date(x1$Date.of.monthly.visit, format = "%d.%m.%y")
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-2 monthly visits 31Jul15.csv", sep=",")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# Format HHID and Listing number to have standard length. Then create unique ID
x1$HHID <-formatC(x1$HHID, width = 3, format = 'd', flag = 0)
x1$Listing.number <- formatC(x1$Listing.number, width = 4, format = 'd', flag = 0)
# create unique ID called "unique_HHID_list_no"
x1$unique_ID <- paste(x1$HHID, x1$Listing.number, sep="-")
# turn date characters into date format
x1$Date.of.monthly.visit <- as.Date(x1$Date.of.monthly.visit, format = "%d.%m.%y")
View(x1)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
mac <- "/Users/Matthew/Google Drive/Copenhagen\\Bangladesh - Cholera\\Map Stuff"
pc <- "C:/Users/wrz741/Dropbox/C5 Baseline data/Pre-double entry"
setwd(pc)
rm(mac, pc)
library(plyr)
library(memisc) # read .spss files
HH_member_info<-as.data.set(spss.system.file('Q11.sav'), stringsAsFactors=FALSE)
# make it easier to work with in R.
# Please change "x" to a variable name that makes sense for you!
x <-as.data.frame(HH_member_info)
# make dummy variable for each age range so counting will be easier
x$child_U5 <- ifelse(x$q11_4 < 5, 1, 0)
x$child_5_17 <- ifelse(x$q11_4 >= 5 & x$q11_4 <18, 1, 0)
x$adult <- ifelse(x$q11_4 > 18, 1, 0)
# For each unique "slno" in df "x", sum the number of adults, children U5 and children 5-17.
# Change "slno" to "hhid" if you wish to count based on HHID.
x2 <- ddply(x, .(slno),
summarize,
adults = sum(adult),
children_U5 = sum(child_U5),
children_5_17 = sum(child_5_17))
# Add HHID variable to make our final dataset.
x3 <- merge(x[,c(1,10)], x2, by = "slno")
# check to make sure summation works as expected. Returns "TRUE" if it works
sum(x$child_U5) == sum(x3$children_U5)
sum(x$child_5_17)== sum(x3$children_5_17)
sum(x$adult)== sum(x3$adults)
View(x3)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-2 monthly visits 31Jul15.csv", sep=",")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# Format HHID and Listing number to have standard length. Then create unique ID
x1$HHID <-formatC(x1$HHID, width = 3, format = 'd', flag = 0)
x1$Listing.number <- formatC(x1$Listing.number, width = 4, format = 'd', flag = 0)
# create unique ID called "unique_HHID_list_no"
x1$unique_ID <- paste(x1$HHID, x1$Listing.number, sep="-")
# turn date characters into date format
x1$Date.of.monthly.visit <- as.Date(x1$Date.of.monthly.visit, format = "%d.%m.%y")
View(x1)
# Author: Matthew Phelps
#Desc: Calculate number of people living in each household at baseline
# Intro -------------------------------------------------------------------
rm(list = ls())
graphics.off()
pc <- "C:/Users/wrz741/Dropbox/C5 Field Operations data/Folder Amal"
setwd(pc)
rm(pc)
library(plyr)
library(xlsx)
x1 <- read.csv("X-2 monthly visits 31Jul15.csv", sep=",")
# remove rows without a HHID
x1 <- x1[complete.cases(x1$HHID),]
# Format HHID and Listing number to have standard length. Then create unique ID
x1$HHID <-formatC(x1$HHID, width = 3, format = 'd', flag = 0)
x1$Listing.number <- formatC(x1$Listing.number, width = 4, format = 'd', flag = 0)
# create unique ID called "unique_HHID_list_no"
x1$unique_ID <- paste(x1$HHID, x1$Listing.number, sep="-")
# turn date characters into date format
x1$Date.of.monthly.visit <- as.Date(x1$Date.of.monthly.visit, format = "%d.%m.%y")
